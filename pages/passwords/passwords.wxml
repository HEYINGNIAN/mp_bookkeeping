<!-- pages/passwords/passwords.wxml -->
<view class="container">
  <!-- å¤´éƒ¨æœç´¢å’Œæ·»åŠ  -->
  <view class="header-section">
    <view class="search-bar card">
      <input class="search-input" placeholder="æœç´¢å¯†ç ..." bindinput="onSearchInput" value="{{searchKeyword}}" />
      <text class="search-icon">ğŸ”</text>
    </view>
    <button class="btn-primary add-btn" bindtap="showAddModal">
      <text class="add-icon">+</text>
      æ·»åŠ å¯†ç 
    </button>
  </view>

  <!-- å¯†ç åˆ—è¡¨ -->
  <view class="passwords-list">
    <view class="password-item card fade-in" wx:for="{{filteredPasswords}}" wx:key="id">
      <view class="password-header">
        <view class="password-icon">{{item.icon}}</view>
        <view class="password-info">
          <text class="password-name">{{item.name}}</text>
          <text class="password-account">{{item.account}}</text>
        </view>
        <view class="password-actions">
          <text class="action-btn" bindtap="togglePassword" data-id="{{item.id}}">
            {{item.showPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸'}}
          </text>
          <text class="action-btn" bindtap="copyPassword" data-id="{{item.id}}">ğŸ“‹</text>
          <text class="action-btn" bindtap="editPassword" data-id="{{item.id}}">âœï¸</text>
          <text class="action-btn" bindtap="deletePassword" data-id="{{item.id}}">ğŸ—‘ï¸</text>
        </view>
      </view>
      
      <view class="password-content">
        <view class="password-field">
          <text class="field-label">å¯†ç :</text>
          <text class="field-value password-text">{{item.showPassword ? item.password : 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢'}}</text>
        </view>
        
        <view class="password-field" wx:if="{{item.url}}">
          <text class="field-label">ç½‘å€:</text>
          <text class="field-value url-text" bindtap="openUrl" data-url="{{item.url}}">{{item.url}}</text>
        </view>
        
        <view class="password-field" wx:if="{{item.note}}">
          <text class="field-label">å¤‡æ³¨:</text>
          <text class="field-value note-text">{{item.note}}</text>
        </view>
      </view>
      
      <view class="password-footer">
        <text class="password-time">{{item.createTime}}</text>
        <view class="password-strength {{item.strength}}">{{item.strengthText}}</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredPasswords.length === 0}}">
    <text class="empty-icon">ğŸ”</text>
    <text class="empty-text">{{searchKeyword ? 'æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å¯†ç ' : 'è¿˜æ²¡æœ‰ä¿å­˜å¯†ç '}}</text>
    <button class="btn-primary" bindtap="showAddModal" wx:if="{{!searchKeyword}}">æ·»åŠ ç¬¬ä¸€ä¸ªå¯†ç </button>
  </view>
</view>

<!-- æ·»åŠ /ç¼–è¾‘å¯†ç å¼¹çª— -->
<view class="modal" wx:if="{{showModal}}">
  <view class="modal-content card">
    <view class="modal-header">
      <text class="modal-title">{{isEdit ? 'ç¼–è¾‘å¯†ç ' : 'æ·»åŠ å¯†ç '}}</text>
      <text class="modal-close" bindtap="hideModal">âœ•</text>
    </view>
    
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">åç§°</text>
        <input class="input-field" placeholder="ä¾‹å¦‚: å¾®ä¿¡ç™»å½•" bindinput="onNameInput" value="{{formData.name}}" />
      </view>
      
      <view class="input-group">
        <text class="input-label">è´¦å·/é‚®ç®±</text>
        <input class="input-field" placeholder="è¯·è¾“å…¥è´¦å·æˆ–é‚®ç®±" bindinput="onAccountInput" value="{{formData.account}}" />
      </view>
      
      <view class="input-group">
        <text class="input-label">å¯†ç </text>
        <view class="password-input-group">
          <input class="input-field password-input" type="{{showPasswordInput ? 'text' : 'password'}}" 
                 placeholder="è¯·è¾“å…¥å¯†ç " bindinput="onPasswordInput" value="{{formData.password}}" />
          <text class="password-toggle" bindtap="togglePasswordInput">
            {{showPasswordInput ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸'}}
          </text>
        </view>
        <view class="password-strength-indicator" wx:if="{{formData.password}}">
          <text class="strength-label">å¯†ç å¼ºåº¦:</text>
          <view class="strength-bar">
            <view class="strength-fill {{passwordStrength}}"></view>
          </view>
          <text class="strength-text">{{strengthText}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">ç½‘å€ (å¯é€‰)</text>
        <input class="input-field" placeholder="https://example.com" bindinput="onUrlInput" value="{{formData.url}}" />
      </view>
      
      <view class="input-group">
        <text class="input-label">å¤‡æ³¨ (å¯é€‰)</text>
        <textarea class="textarea-field" placeholder="æ·»åŠ å¤‡æ³¨ä¿¡æ¯" bindinput="onNoteInput" value="{{formData.note}}"></textarea>
      </view>
      
      <view class="input-group">
        <text class="input-label">å›¾æ ‡</text>
        <scroll-view class="icon-selector" scroll-x="true">
          <text class="icon-item {{formData.icon === item ? 'selected' : ''}}" 
                wx:for="{{icons}}" 
                wx:key="*this" 
                wx:for-item="icon"
                bindtap="selectIcon" 
                data-icon="{{icon}}">{{icon}}</text>
        </scroll-view>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="btn-secondary" bindtap="hideModal">å–æ¶ˆ</button>
      <button class="btn-primary" bindtap="savePassword">ä¿å­˜</button>
    </view>
  </view>
</view>
